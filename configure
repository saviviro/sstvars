#!/bin/sh

# Detect the operating system
OS=$(uname -s)
echo "Operating System detected: $OS"

# Only create Makevars for Linux
if [ "$OS" = "Linux" ]; then
  echo "Generating src/Makevars for Linux (CRAN/Debian)..."
  mkdir -p src
  cat > src/Makevars <<'EOF'
# Use C++14 so Armadillo 'current' is allowed; define macro for all TUs (incl. RcppExports.cpp)
CXX_STD = CXX14
PKG_CPPFLAGS = -DARMA_USE_CURRENT

# Your original flags (kept exactly as you wanted them)
PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS)
PKG_LIBS     = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS) $(SHLIB_OPENMP_CXXFLAGS)
EOF
  echo "Contents of src/Makevars:"
  cat src/Makevars
else
  echo "No action needed for macOS."
fi

echo "configure script completed."
